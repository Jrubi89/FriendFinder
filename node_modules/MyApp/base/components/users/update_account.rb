class Users

  def update_account user_id, params

    password = params.delete('password')
    if !password.nil? && !password.empty?
      old_password = @user.password
      @user.password, @user.password_salt = generate_password_pair(password)

      Authlog.create({
        user_id: @user.id,
        time: Time.now.utc,
        ip: request.ip,
        action: :admin_reset_password,
        old_password: old_password,
        new_password: @user.password
      })

      @user.save
    end

    @user.update_attributes(params)
    true
  end
end

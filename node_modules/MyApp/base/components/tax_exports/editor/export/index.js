import Pikaday from 'helpers/pikaday'
import Serialize from 'form-serialize'
import Alert from 'appril-alert'

export default {
  props: ['item'],
  template: require('./template'),

  mounted() {
    for (let e of this.$el.querySelectorAll('.datepicker')) {
      new Pikaday({field: e})
    }
  },

  methods: {
    xport(evt) {
      let form = evt.target.closest('form')

      if (!$(form).parsley().validate())
        return

      this.api.export(this.item.id, Serialize(form, {hash: true})).send({
        success: (item) => this.$store.commit('CRUDLE__UPDATE_ITEM', item)
      })
    }
  }
}

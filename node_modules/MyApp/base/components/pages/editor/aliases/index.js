import Alert from 'appril-alert'
import Serialize from 'form-serialize'

import {page_url} from '../../helpers'

export default {
  props: ['item'],
  template: require('./template'),

  methods: {
    page_url,

    create_alias(evt) {

      let form = evt.target.closest('form')
      if (!$(form).parsley().validate())
        return

      this.api.create_alias(this.item.id, Serialize(form, {hash: true})).send({
        success: (alias) => {
          this.$store.commit('PAGES__ADD_ALIAS', alias)
          form.reset()
        }
      })
    },

    delete_alias(alias_id, index) {
      Alert.confirm(() => {
        this.api.delete_alias(this.item.id, alias_id).send({
          success: () => this.$store.commit('PAGES__DELETE_ALIAS', index)
        })
      })
    }

  }
}
